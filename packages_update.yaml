- name: playbook pour upgrader des packages sp√©cifique 
  #gather_facts: no
  become: yes
  tasks: 
    - name: repository de google chrome 
      apt_repository: 
        repo: deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main
        state: present
        filename: google-chrome_repository 
        
    - name: ajout cle 
      shell: wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add -       

    - name: executer un upgrade des packages cibles
      apt:
        name: "{{ packages }}" 
        state: installed # valeurs possibles absent, build-dep, installed, latest, present, removed, present
        update_cache: yes
      vars:
        packages:
          - x11vnc
          - wget
          - rdesktop
          - thunderbird
          - firefox
          - libreoffice
          - google-chrome-stable

#    - name: repository de wps office
#      shell: wget http://kdl.cc.ksosoft.com/wps-community/download/8392/wps-office_11.1.0.8392_amd64.deb | dpkg -i wps-office_11.1.0.8392_amd64.deb
#      args:
#        chdir: /home/ansible/

    - name: reboot the host
      shell: "sleep 5 && reboot"
      async: 1
      poll: 0

    - name: attendre le reboot de l'host 
      wait_for_connection:
        connect_timeout: 10
        sleep: 5
        delay: 5
        timeout: 300

    - name: Check the Uptime of the servers
      shell: "uptime"
      register: Uptime

    - debug: var=Uptime